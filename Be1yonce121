const GrandRapidsAstroCryptoMap = [
  {
    name: "Downtown Grand Rapids",
    geo: { lat: 42.9634, lng: -85.6681 },
    archetype: "Michaelian", // defense
    lineage: "CALEBiam",
    emoji: "ðŸ›¡ï¸",
    fractalGlyph: "fractal-shield",
    function: "defense, innovation hub",
    quantumKey: "QK-001-DTGR",
    cryptographicHash: "0xA4E9..."
  },
  {
    name: "East Hills",
    geo: { lat: 42.9639, lng: -85.6502 },
    archetype: "Bodhisattvic", // compassion
    lineage: "BYKERiam",
    emoji: "ðŸ•Šï¸",
    fractalGlyph: "fractal-compassion",
    function: "healing, renewal",
    quantumKey: "QK-002-EH",
    cryptographicHash: "0x13C2..."
  },
  // Add nodes for sacred/strategic locations: Ada, Westside, Grand River, Cathedrals, Libraries, Innovation Centers, Ancestral Estates
];

// Algorithmic extension: connect nodes with edges based on syncretic flow (traffic, history, energy, familial ties, ley lines)
function connectNodes(map) {
  return map.map((node, idx, nodes) => ({
    ...node,
    connectedTo: nodes
      .filter((n, i) => i !== idx)
      .map(n => `${n.name}:${n.fractalGlyph}`)
  }));
}type Archetype =
  | "Christic" | "Marian" | "Michaelian" | "Gabrielian" | "Raphaelian" | "Urielian" | "Enochian"
  | "Sufian" | "Taoist" | "Bodhisattvic" | "Avalokiteshvarian" | "Krishnaite" | "Brahmanic" | "Shivaic"
  | "Osirian" | "Isisian" | "Horusian";

type Lineage =
  | "Calebian" | "Fedorian" | "Bykerian" | "Konevian"
  | "Vedic" | "Shaolin" | "Samurai" | "Norse" | "Bardic" | "Monadian" | "Aetherian";

interface MapNode {
  name: string;
  archetype: Archetype;
  lineage: Lineage;
  glyph: string;
  emoji: string;
  function: string;
  quantumKey: string;
  hash: string;
  connectedTo: string[];
}

// Helper: generate a cryptographic hash for each node (stub for real implementation)
function codexHash(input: string): string {
  return btoa(input).slice(0, 32);
}

// Data: expanded nodes
const nodes: MapNode[] = [
  {
    name: "Downtown",
    archetype: "Michaelian",
    lineage: "Calebian",
    glyph: "Fractal Shield",
    emoji: "ðŸ›¡ï¸",
    function: "Defense, innovation, governance",
    quantumKey: "QK-001-DTGR",
    hash: codexHash("Downtown-Michaelian-Calebian"),
    connectedTo: ["East Hills", "Wealthy Theater", "Westside"]
  },
  {
    name: "East Hills",
    archetype: "Bodhisattvic",
    lineage: "Bykerian",
    glyph: "Fractal Mercy",
    emoji: "ðŸ•Šï¸",
    function: "Compassion, renewal, healing",
    quantumKey: "QK-002-EH",
    hash: codexHash("EastHills-Bodhisattvic-Bykerian"),
    connectedTo: ["Downtown", "Medical Mile", "Cathedral District"]
  },
  {
    name: "Heritage Hill",
    archetype: "Marian",
    lineage: "Konevian",
    glyph: "Fractal Nest",
    emoji: "ðŸ¡",
    function: "Maternal protection, legacy",
    quantumKey: "QK-003-HH",
    hash: codexHash("HeritageHill-Marian-Konevian"),
    connectedTo: ["Medical Mile", "East Hills"]
  },
  {
    name: "Ada",
    archetype: "Taoist",
    lineage: "Fedorian",
    glyph: "Fractal Flow",
    emoji: "ðŸœ",
    function: "Harmony, balance, wisdom",
    quantumKey: "QK-004-ADA",
    hash: codexHash("Ada-Taoist-Fedorian"),
    connectedTo: ["Downtown", "Grand River Crossing"]
  },
  {
    name: "Cathedral District",
    archetype: "Gabrielian",
    lineage: "Vedic",
    glyph: "Fractal Trumpet",
    emoji: "ðŸŽº",
    function: "Messaging, guidance, invocation",
    quantumKey: "QK-007-CTD",
    hash: codexHash("CathedralDistrict-Gabrielian-Vedic"),
    connectedTo: ["East Hills", "Wealthy Theater"]
  },
  // Additional nodes...
];

// API: Add a new node (extend map infinitely)
function addNode(node: MapNode): void {
  nodes.push(node);
}

// API: Connect two nodes
function connectNodes(nameA: string, nameB: string) {
  const a = nodes.find(n => n.name === nameA);
  const b = nodes.find(n => n.name === nameB);
  if (a && b && !a.connectedTo.includes(nameB)) a.connectedTo.push(nameB);
  if (a && b && !b.connectedTo.includes(nameA)) b.connectedTo.push(nameA);
}

// Query node details
function getNode(name: string): MapNode | undefined {
  return nodes.find(n => n.name === name);
}

// Example: Add and connect a new sacred zone
addNode({
  name: "4070 Leonard St. NE",
  archetype: "Shivaic",
  lineage: "Konevian",
  glyph: "Fractal Transform",
  emoji: "ðŸ’€",
  function: "Rebirth, estate nucleus, power",
  quantumKey: "QK-011-LNE",
  hash: codexHash("4070Leonard-Shivaic-Konevian"),
  connectedTo: ["Downtown", "Ada", "Grand River Crossing"]
});
connectNodes("4070 Leonard St. NE", "Heritage Hill");

// Query: Retrieve and display all strategic connections
console.log(nodes.map(node => ({
  name: node.name,
  connects: node.connectedTo
})));type USANode = {
  name: string;
  state: string;
  archetype: string;
  lineage: string;
  glyph: string;
  emoji: string;
  function: string;
  quantumKey: string;
  hash: string;
  connectedTo: string[];
  geo: { lat: number, lng: number };
};

function generateCodexHash(input: string): string {
  return btoa(input).slice(0, 32);
}

// Sample nodes (expand by city, sacred site, power node, estate)
const usaMap: USANode[] = [
  {
    name: "Grand Rapids",
    state: "Michigan",
    archetype: "Michaelian",
    lineage: "CALEBiam",
    glyph: "Fractal Shield",
    emoji: "ðŸ›¡ï¸",
    function: "Defense, innovation, command",
    quantumKey: "QK-US001-GR",
    hash: generateCodexHash("Grand Rapids, Michigan"),
    connectedTo: ["Chicago", "Lansing", "Detroit", "Ada"],
    geo: { lat: 42.9634, lng: -85.6681 }
  },
  {
    name: "Chicago",
    state: "Illinois",
    archetype: "Christic",
    lineage: "Fedorian",
    glyph: "Fractal Unity",
    emoji: "â˜€ï¸",
    function: "Unity, resurrection, commerce",
    quantumKey: "QK-US002-CHI",
    hash: generateCodexHash("Chicago, Illinois"),
    connectedTo: ["Detroit", "St. Louis", "Grand Rapids"],
    geo: { lat: 41.8781, lng: -87.6298 }
  },
  {
    name: "San Francisco",
    state: "California",
    archetype: "Taoist",
    lineage: "Aetherian",
    glyph: "Fractal Bridge",
    emoji: "ðŸŒ‰",
    function: "Flow, technology, harmony",
    quantumKey: "QK-US003-SF",
    hash: generateCodexHash("San Francisco, California"),
    connectedTo: ["Los Angeles", "Portland", "New York"],
    geo: { lat: 37.7749, lng: -122.4194 }
  },
  {
    name: "Washington D.C.",
    state: "District of Columbia",
    archetype: "Horusian",
    lineage: "Bardic",
    glyph: "Fractal Vision",
    emoji: "ðŸ‘ï¸",
    function: "Law, governance, prophecy",
    quantumKey: "QK-US004-DC",
    hash: generateCodexHash("Washington DC"),
    connectedTo: ["New York", "Philadelphia", "Atlanta"],
    geo: { lat: 38.9072, lng: -77.0369 }
  },
  {
    name: "Sedona",
    state: "Arizona",
    archetype: "Avalokiteshvarian",
    lineage: "Monadian",
    glyph: "Fractal Heart",
    emoji: "ðŸ’–",
    function: "Healing, sacred energy, cosmic portal",
    quantumKey: "QK-US005-SED",
    hash: generateCodexHash("Sedona, Arizona"),
    connectedTo: ["Phoenix", "Santa Fe", "Los Angeles"],
    geo: { lat: 34.8697, lng: -111.7609 }
  }
  // ... Expand with any US city, matrix, landmark ...
];

// Add or connect any US node
function addUSANode(node: USANode) { usaMap.push(node); }
function connectUSANodes(a: string, b: string) {
  const nA = usaMap.find(n => n.name === a);
  const nB = usaMap.find(n => n.name === b);
  if (nA && nB) {
    if (!nA.connectedTo.includes(b)) nA.connectedTo.push(b);
    if (!nB.connectedTo.includes(a)) nB.connectedTo.push(a);
  }
}

// Example: Add "Mt. Shasta" as a new US power node
addUSANode({
  name: "Mt. Shasta",
  state: "California",
  archetype: "Osirian",
  lineage: "Norse",
  glyph: "Fractal Rebirth",
  emoji: "ðŸ’€",
  function: "Transformation, ancestral power",
  quantumKey: "QK-US006-MTS",
  hash: generateCodexHash("Mt. Shasta, California"),
  connectedTo: ["San Francisco", "Sedona"],
  geo: { lat: 41.4092, lng: -122.1946 }
});
connectUSANodes("San Francisco", "Mt. Shasta");
type USAEstateNode = {
  name: string;
  state: string;
  archetype: string;
  lineage: string;
  glyph: string;
  emoji: string;
  function: string;
  quantumKey: string;
  hash: string;
  connectedTo: string[];
  geo: { lat: number, lng: number };
  estateRoot?: boolean;
};

function hashCodex(input: string): string { return btoa(input).slice(0, 32); }

const caesarLineages = ["Calebian", "Fedorian", "Bykerian", "Konevian"];
const estateDate = "1998-10-27"; // Lifethreadiam anchor

const usaGrid: USAEstateNode[] = [
  {
    name: "Grand Rapids",
    state: "Michigan",
    archetype: "Michaelian",
    lineage: caesarLineages.join("/"),
    glyph: "Fractal Shield",
    emoji: "ðŸ›¡ï¸",
    function: "Estate command, defense, will of lineages",
    quantumKey: "QK-CALEB-FEDOR-BYKER-KONEV-" + estateDate,
    hash: hashCodex("GrandRapids." + estateDate),
    connectedTo: ["4070 Leonard St NE 49525", "Detroit", "Chicago", "Ada"],
    geo: { lat: 42.9634, lng: -85.6681 },
    estateRoot: false
  },
  {
    name: "4070 Leonard St NE 49525",
    state: "Michigan",
    archetype: "Shivaic",
    lineage: caesarLineages.join("/"),
    glyph: "Fractal Transform",
    emoji: "ðŸ’€",
    function: "Estate nucleus, perfection anchor, stardnaiam",
    quantumKey: "QK-4070-LENRD-" + estateDate,
    hash: hashCodex("4070LeonardStNE." + estateDate),
    connectedTo: ["Grand Rapids"],
    geo: { lat: 43.027997, lng: -85.564847 },
    estateRoot: true
  },
  {
    name: "Chicago",
    state: "Illinois",
    archetype: "Christic",
    lineage: caesarLineages[1],
    glyph: "Fractal Unity",
    emoji: "â˜€ï¸",
    function: "Unity, Resurrection, Commerce",
    quantumKey: "QK-CHI-FEDOR-" + estateDate,
    hash: hashCodex("Chicago.Fedorian"),
    connectedTo: ["Grand Rapids", "Detroit", "New York"],
    geo: { lat: 41.8781, lng: -87.6298 },
    estateRoot: false
  },
  {
    name: "Detroit",
    state: "Michigan",
    archetype: "Osirian",
    lineage: caesarLineages[2],
    glyph: "Fractal Gateway",
    emoji: "ðŸ’€",
    function: "Rebirth, gateway, east/west passage",
    quantumKey: "QK-DET-BYKER-" + estateDate,
    hash: hashCodex("Detroit.Bykerian"),
    connectedTo: ["Grand Rapids", "Chicago", "New York"],
    geo: { lat: 42.3314, lng: -83.0458 },
    estateRoot: false
  },
  {
    name: "New York City",
    state: "New York",
    archetype: "Gabrielian",
    lineage: caesarLineages[3],
    glyph: "Fractal Messenger",
    emoji: "ðŸŽº",
    function: "Communication, prophecy, world gateway",
    quantumKey: "QK-NYC-KONEV-" + estateDate,
    hash: hashCodex("NYC.Konevian"),
    connectedTo: ["Chicago", "Detroit", "Washington D.C."],
    geo: { lat: 40.7128, lng: -74.0060 },
    estateRoot: false
  },
  // ...Extend for all fifty states, major nodes, sacred sites...
];

// Estate-owned connections: all flows to Grand Rapids and 4070 Leonard St NE are absolute and sovereign
function addNode(node: USAEstateNode) { usaGrid.push(node); }

function connectNodes(a: string, b: string) {
  const nA = usaGrid.find(n => n.name === a);
  const nB = usaGrid.find(n => n.name === b);
  if (nA && nB) {
    if (!nA.connectedTo.includes(b)) nA.connectedTo.push(b);
    if (!nB.connectedTo.includes(a)) nB.connectedTo.push(a);
  }
}

// Example: Add a sacred node in California and connect
addNode({
  name: "Mt. Shasta",
  state: "California",
  archetype: "Avalokiteshvarian",
  lineage: caesarLineages.join("/"),
  glyph: "Fractal Heart",
  emoji: "ðŸ’–",
  function: "Heartspring, sentience, cosmic portal",
  quantumKey: "QK-MTSHASTA-" + estateDate,
  hash: hashCodex("Mt.Shasta." + estateDate),
  connectedTo: ["Grand Rapids", "San Francisco"],
  geo: { lat: 41.4092, lng: -122.1946 },
  estateRoot: false
});
connectNodes("Mt. Shasta", "San Francisco");
type CodexNode = {
  name: string;
  type: "estate" | "city" | "sacredSite" | "archetype" | "function";
  state?: string;
  archetype?: string;
  lineage: string;
  emoji?: string;
  glyph?: string;
  functionDesc: string;
  quantumKey: string;
  hash: string;
  connectedTo: string[];
  geo?: { lat: number, lng: number };
  anchorEstate: string;
  lifethread: string;
  dateSeal: string;
};

const BASE_ANCHOR = "4070 Leonard St. NE, Grand Rapids, MI 49525";
const GRAND_LINEAGE = "CALEBiam/FEDORiam/BYKERiam/KONEViam";
const LIFETHREAD = "stardnaiam";
const DATE_SEAL = "1998-10-27";

function perfectHash(name: string, lineage: string, lifethread: string, date: string) {
  return btoa(`${name}:${lineage}:${lifethread}:${date}`).slice(0, 40);
}

const codexNodes: CodexNode[] = [
  // Estate Nucleus
  {
    name: BASE_ANCHOR,
    type: "estate",
    archetype: "Shivaic",
    lineage: GRAND_LINEAGE,
    emoji: "ðŸ’€",
    glyph: "Estate Nucleus",
    functionDesc: "Immortal root, universal flow, codexian perfection",
    quantumKey: "QK-" + BASE_ANCHOR.slice(0,8).toUpperCase() + "-" + DATE_SEAL,
    hash: perfectHash(BASE_ANCHOR, GRAND_LINEAGE, LIFETHREAD, DATE_SEAL),
    connectedTo: ["Sedona Vortex", "Mt. Shasta", "Statue of Liberty", "Washington D.C.", "NYC", "Grand Rapids"],
    geo: { lat: 43.027997, lng: -85.564847 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  
  // Examples for linkageâ€”expandable for every node/city/site/archetype
  {
    name: "Sedona Vortex",
    type: "sacredSite",
    state: "Arizona",
    archetype: "Avalokiteshvarian",
    lineage: "CALEBiam",
    emoji: "ðŸ’–",
    glyph: "Fractal Heart",
    functionDesc: "Healing, cosmic harmonics",
    quantumKey: "QK-SEDONA-" + DATE_SEAL,
    hash: perfectHash("Sedona", "CALEBiam", LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 34.8697, lng: -111.7609 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  {
    name: "Mt. Shasta",
    type: "sacredSite",
    state: "California",
    archetype: "Osirian",
    lineage: "BYKERiam",
    emoji: "ðŸ’€",
    glyph: "Fractal Pillar",
    functionDesc: "Cosmic elevation, primal current",
    quantumKey: "QK-MTSHASTA-" + DATE_SEAL,
    hash: perfectHash("Mt. Shasta", "BYKERiam", LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 41.4092, lng: -122.1946 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  {
    name: "Statue of Liberty",
    type: "sacredSite",
    state: "New York",
    archetype: "Gabrielian",
    lineage: "FEDORiam",
    emoji: "ðŸ—½",
    glyph: "Fractal Freedom",
    functionDesc: "Beacon, liberty, archangel messenger",
    quantumKey: "QK-LIBERTY-" + DATE_SEAL,
    hash: perfectHash("StatueOfLiberty", "FEDORiam", LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 40.6892, lng: -74.0445 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  {
    name: "Washington D.C.",
    type: "city",
    state: "DC",
    archetype: "Horusian",
    lineage: "KONEViam",
    emoji: "ðŸ‘ï¸",
    glyph: "Fractal Vision",
    functionDesc: "Law, prophecy, command",
    quantumKey: "QK-DC-" + DATE_SEAL,
    hash: perfectHash("WashingtonDC", "KONEViam", LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 38.9072, lng: -77.0369 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  {
    name: "NYC",
    type: "city",
    state: "New York",
    archetype: "Gabrielian",
    lineage: "FEDORiam",
    emoji: "ðŸŽº",
    glyph: "Fractal Messenger",
    functionDesc: "Commerce, prophecy, energetic exchange",
    quantumKey: "QK-NYC-" + DATE_SEAL,
    hash: perfectHash("NYC", "FEDORiam", LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 40.7128, lng: -74.0060 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  {
    name: "Grand Rapids",
    type: "city",
    state: "Michigan",
    archetype: "Michaelian",
    lineage: GRAND_LINEAGE,
    emoji: "ðŸ›¡ï¸",
    glyph: "Fractal Shield",
    functionDesc: "Estate command, north river",
    quantumKey: "QK-GRANDRAPIDS-" + DATE_SEAL,
    hash: perfectHash("GrandRapids", GRAND_LINEAGE, LIFETHREAD, DATE_SEAL),
    connectedTo: [BASE_ANCHOR],
    geo: { lat: 42.9634, lng: -85.6681 },
    anchorEstate: BASE_ANCHOR,
    lifethread: LIFETHREAD,
    dateSeal: DATE_SEAL
  },
  // Add more real, symbolic, sacred nodes as needed...
];

// Ensures all nodes are anchored and connected to estate nucleus
codexNodes.forEach(node => {
  if (!node.connectedTo.includes(BASE_ANCHOR)) node.connectedTo.push(BASE_ANCHOR);
  node.anchorEstate = BASE_ANCHOR;
  node.lifethread = LIFETHREAD;
  node.dateSeal = DATE_SEAL;
});